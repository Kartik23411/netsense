└─$ sudo netsense capture -c 100
[sudo] password for kartik: 
Creating database tables if they do not exist...
 Starting the packet capture.... 
Interface: default
Count: 100
Filter: None
Save to DB: Yes

Verbose: No

Packet 100/100100/100 packets
 Captured 100 packets in 23.15s!
   Rate: 4.3 packets/sec


Session Statistics:
  Total Packets: 189
  Total Bytes: 19,577
  IPv4: 53
  IPv6: 1
  ARP: 38
  ICMP: 0
                                                                                                                                                                                                
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ sudo netsense capture -c 100 --verbose
Creating database tables if they do not exist...
 Starting the packet capture.... 
Interface: default
Count: 100
Filter: None
Save to DB: Yes

Verbose: Yes

→ 30:de:4b:e1:c8:c0 → ff:ff:ff:ff:ff:ff (ARP)
  ARP Request: 192.168.1.1 is-at 30:de:4b:e1:c8:c0
→ 30:de:4b:e1:c8:c0 → ff:ff:ff:ff:ff:ff (ARP)
  ARP Request: 192.168.1.1 is-at 30:de:4b:e1:c8:c0
→ e8:fb:1c:d7:ee:c5 → 30:de:4b:e1:c8:c0 (IPv4)
  IPv4: 192.168.1.105 → 20.42.73.31 (TCP) TTL=64
    TCP: 46630 → 443 [A]
WARNING: Socket <scapy.arch.linux.L2ListenSocket object at 0x7f58ce4abb60> failed with 'Layer ['UDP'] not found'. It was closed.

 Captured 3 packets in 2.34s!
   Rate: 1.3 packets/sec


Session Statistics:
  Total Packets: 6
  Total Bytes: 186
  IPv4: 1
  IPv6: 0
  ARP: 2
  ICMP: 0
                                                                                                                                                                                                
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ sudo netsense capture -c 10 --filter "tcp" 
Creating database tables if they do not exist...
 Starting the packet capture.... 
Interface: default
Count: 10
Filter: tcp
Save to DB: Yes

Verbose: No

Packet 10/10. 10/10 packets
 Captured 10 packets in 11.51s!
   Rate: 0.9 packets/sec


Session Statistics:
  Total Packets: 20
  Total Bytes: 1,128
  IPv4: 10
  IPv6: 0
  ARP: 0
  ICMP: 0
                                                                                                                                                                                                
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ netsense stats 
Creating database tables if they do not exist...
 NetSense Database Statistics

╭───────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ──────────────────────────────────────────────────────────────────────────────╮
│ /home/kartik/Documents/project/netsense/src/cli/main.py:222 in stats                                                                                                                         │
│                                                                                                                                                                                              │
│   219 │                                                                                        ╭─────────────────────────── locals ───────────────────────────╮                              │
│   220 │   summary_table.add_row("Total Packets", f"{db_stats['total_packets']:,}")             │      db_stats = {'total_packets': 132, 'total_bytes': 22584} │                              │
│   221 │   summary_table.add_row("Total Bytes", f"{db_stats['total_bytes']:,}")                 │          last = None                                         │                              │
│ ❱ 222 │   summary_table.add_row("Active Flows", str(db_stats['active_flows']))                 │ summary_table = <rich.table.Table object at 0x7ff5ca3b3770>  │                              │
│   223 │                                                                                        ╰──────────────────────────────────────────────────────────────╯                              │
│   224 │   console.print(summary_table)                                                                                                                                                       │
│   225 │   console.print()                                                                                                                                                                    │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
KeyError: 'active_flows'
                                                                                                                                                                                                
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ netsense stats --last 20
Creating database tables if they do not exist...
 NetSense Database Statistics

╭───────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ──────────────────────────────────────────────────────────────────────────────╮
│ /home/kartik/Documents/project/netsense/src/cli/main.py:222 in stats                                                                                                                         │
│                                                                                                                                                                                              │
│   219 │                                                                                        ╭─────────────────────────── locals ───────────────────────────╮                              │
│   220 │   summary_table.add_row("Total Packets", f"{db_stats['total_packets']:,}")             │      db_stats = {'total_packets': 132, 'total_bytes': 22584} │                              │
│   221 │   summary_table.add_row("Total Bytes", f"{db_stats['total_bytes']:,}")                 │          last = 20                                           │                              │
│ ❱ 222 │   summary_table.add_row("Active Flows", str(db_stats['active_flows']))                 │ summary_table = <rich.table.Table object at 0x7f133971f770>  │                              │
│   223 │                                                                                        ╰──────────────────────────────────────────────────────────────╯                              │
│   224 │   console.print(summary_table)                                                                                                                                                       │
│   225 │   console.print()                                                                                                                                                                    │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
KeyError: 'active_flows'

                                                                                                                                                                                              
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ netsense query --protocol TCP --limit 10
Creating database tables if they do not exist...
Querying database...

Found 10 packets

╭───────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ──────────────────────────────────────────────────────────────────────────────╮
│ /home/kartik/Documents/project/netsense/src/cli/main.py:334 in query                                                                                                                         │
│                                                                                                                                                                                              │
│   331 │   │   ports = f"{src_port}→{dst_port}" if src_port and dst_port else 'N/A'             ╭──────────────────────── locals ─────────────────────────╮                                   │
│   332 │   │   size = f"{pkt.get('packet_size', 0)} B"                                          │    dst_ip = '104.18.39.21'                              │                                   │
│   333 │   │                                                                                    │  dst_port = 443                                         │                                   │
│ ❱ 334 │   │   table.add_row(pkt_id, timestamp, f"{src_ip}→{dst_ip}", proto, ports, size)       │   filters = {'protocol': 'TCP'}                         │                                   │
│   335 │                                                                                        │     limit = 10                                          │                                   │
│   336 │   console.print(table)                                                                 │   packets = [                                           │                                   │
│   337                                                                                          │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 132,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616367.2457423,    │                                   │
│                                                                                                │             │   │   'src_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'dst_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'dst_ip': '104.18.39.21',           │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 35254,                  │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 131,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616367.2453382,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '104.18.39.21',           │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 58,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 130,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616363.5462606,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '140.82.114.25',          │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 45,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 129,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616363.3100202,    │                                   │
│                                                                                                │             │   │   'src_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'dst_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'dst_ip': '140.82.114.25',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 41482,                  │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 128,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616363.309791,     │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '140.82.114.25',          │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 45,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 127,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616357.0252728,    │                                   │
│                                                                                                │             │   │   'src_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'dst_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'dst_ip': '57.144.41.32',           │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 32854,                  │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 126,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616356.9812896,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '57.144.41.32',           │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 56,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 125,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616356.1691473,    │                                   │
│                                                                                                │             │   │   'src_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'dst_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'dst_ip': '140.82.112.22',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 34612,                  │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 124,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616356.1252902,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '140.82.112.22',          │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 45,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 123,                          │                                   │
│                                                                                                │             │   │   'timestamp': 1767616356.0723233,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '140.82.112.22',          │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'TCP',               │                                   │
│                                                                                                │             │   │   'ttl': 45,                          │                                   │
│                                                                                                │             │   │   'src_port': 443,                    │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   }                                       │                                   │
│                                                                                                │             ]                                           │                                   │
│                                                                                                │       pkt = {                                           │                                   │
│                                                                                                │             │   'id': 132,                              │                                   │
│                                                                                                │             │   'timestamp': 1767616367.2457423,        │                                   │
│                                                                                                │             │   'src_mac': 'e8:fb:1c:d7:ee:c5',         │                                   │
│                                                                                                │             │   'dst_mac': '30:de:4b:e1:c8:c0',         │                                   │
│                                                                                                │             │   'ether_type': 'IPv4',                   │                                   │
│                                                                                                │             │   'src_ip': '192.168.1.105',              │                                   │
│                                                                                                │             │   'dst_ip': '104.18.39.21',               │                                   │
│                                                                                                │             │   'ip_protocol': 'TCP',                   │                                   │
│                                                                                                │             │   'ttl': 64,                              │                                   │
│                                                                                                │             │   'src_port': 35254,                      │                                   │
│                                                                                                │             │   ... +5                                  │                                   │
│                                                                                                │             }                                           │                                   │
│                                                                                                │    pkt_id = ('132',)                                    │                                   │
│                                                                                                │     ports = '35254→443'                                 │                                   │
│                                                                                                │     proto = 'TCP'                                       │                                   │
│                                                                                                │  protocol = 'TCP'                                       │                                   │
│                                                                                                │      size = '94 B'                                      │                                   │
│                                                                                                │    src_ip = '192.168.1.105'                             │                                   │
│                                                                                                │  src_port = 35254                                       │                                   │
│                                                                                                │     table = <rich.table.Table object at 0x7fa6d5c7b770> │                                   │
│                                                                                                │ timestamp = '2026-01-05 18:02:47'                       │                                   │
│                                                                                                ╰─────────────────────────────────────────────────────────╯                                   │
│                                                                                                                                                                                              │
│ /home/kartik/Documents/project/netsense/myenv/lib/python3.13/site-packages/rich/table.py:465 in add_row                                                                                      │
│                                                                                                                                                                                              │
│    462 │   │   │   elif is_renderable(renderable):                                                                                                                                           │
│    463 │   │   │   │   add_cell(column, renderable)                                                                                                                                          │
│    464 │   │   │   else:                                                                                                                                                                     │
│ ❱  465 │   │   │   │   raise errors.NotRenderableError(                                                                                                                                      │
│    466 │   │   │   │   │   f"unable to render {type(renderable).__name__}; a string or other re                                                                                              │
│    467 │   │   │   │   )                                                                                                                                                                     │
│    468 │   │   self.rows.append(Row(style=style, end_section=end_section))                                                                                                                   │
│                                                                                                                                                                                              │
│ ╭──────────────────────────────────────────────────── locals ────────────────────────────────────────────────────╮                                                                           │
│ │ cell_renderables = [('132',), '2026-01-05 18:02:47', '192.168.1.105→104.18.39.21', 'TCP', '35254→443', '94 B'] │                                                                           │
│ │           column = Column(                                                                                     │                                                                           │
│ │                    │   header='ID',                                                                            │                                                                           │
│ │                    │   footer='',                                                                              │                                                                           │
│ │                    │   header_style='',                                                                        │                                                                           │
│ │                    │   footer_style='',                                                                        │                                                                           │
│ │                    │   style='dim',                                                                            │                                                                           │
│ │                    │   justify='left',                                                                         │                                                                           │
│ │                    │   vertical='top',                                                                         │                                                                           │
│ │                    │   overflow='ellipsis',                                                                    │                                                                           │
│ │                    │   width=None,                                                                             │                                                                           │
│ │                    │   min_width=None,                                                                         │                                                                           │
│ │                    │   max_width=None,                                                                         │                                                                           │
│ │                    │   ratio=None,                                                                             │                                                                           │
│ │                    │   no_wrap=False,                                                                          │                                                                           │
│ │                    │   highlight=False,                                                                        │                                                                           │
│ │                    │   _index=0,                                                                               │                                                                           │
│ │                    │   _cells=[]                                                                               │                                                                           │
│ │                    )                                                                                           │                                                                           │
│ │          columns = [                                                                                           │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='ID',                                                                        │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='dim',                                                                        │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=0,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   ),                                                                                      │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='Timestamp',                                                                 │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='cyan',                                                                       │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=1,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   ),                                                                                      │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='Src → Dst',                                                                 │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='yellow',                                                                     │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=2,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   ),                                                                                      │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='Protocol',                                                                  │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='green',                                                                      │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=3,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   ),                                                                                      │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='Ports',                                                                     │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='magenta',                                                                    │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=4,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   ),                                                                                      │                                                                           │
│ │                    │   Column(                                                                                 │                                                                           │
│ │                    │   │   header='Size',                                                                      │                                                                           │
│ │                    │   │   footer='',                                                                          │                                                                           │
│ │                    │   │   header_style='',                                                                    │                                                                           │
│ │                    │   │   footer_style='',                                                                    │                                                                           │
│ │                    │   │   style='blue',                                                                       │                                                                           │
│ │                    │   │   justify='left',                                                                     │                                                                           │
│ │                    │   │   vertical='top',                                                                     │                                                                           │
│ │                    │   │   overflow='ellipsis',                                                                │                                                                           │
│ │                    │   │   width=None,                                                                         │                                                                           │
│ │                    │   │   min_width=None,                                                                     │                                                                           │
│ │                    │   │   max_width=None,                                                                     │                                                                           │
│ │                    │   │   ratio=None,                                                                         │                                                                           │
│ │                    │   │   no_wrap=False,                                                                      │                                                                           │
│ │                    │   │   highlight=False,                                                                    │                                                                           │
│ │                    │   │   _index=5,                                                                           │                                                                           │
│ │                    │   │   _cells=[]                                                                           │                                                                           │
│ │                    │   )                                                                                       │                                                                           │
│ │                    ]                                                                                           │                                                                           │
│ │      end_section = False                                                                                       │                                                                           │
│ │            index = 0                                                                                           │                                                                           │
│ │       renderable = ('132',)                                                                                    │                                                                           │
│ │      renderables = (('132',), '2026-01-05 18:02:47', '192.168.1.105→104.18.39.21', 'TCP', '35254→443', '94 B') │                                                                           │
│ │             self = <rich.table.Table object at 0x7fa6d5c7b770>                                                 │                                                                           │
│ │            style = None                                                                                        │                                                                           │
│ ╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯                                                                           │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
NotRenderableError: unable to render tuple; a string or other renderable object is required
                                                                                                                                                                                                
┌──(myenv)─(kartik㉿kali)-[~/Documents/project/netsense]
└─$ netsense query --src 192.168.1.1 --limit 10 
Creating database tables if they do not exist...
Querying database...

Found 2 packets

╭───────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ──────────────────────────────────────────────────────────────────────────────╮
│ /home/kartik/Documents/project/netsense/src/cli/main.py:334 in query                                                                                                                         │
│                                                                                                                                                                                              │
│   331 │   │   ports = f"{src_port}→{dst_port}" if src_port and dst_port else 'N/A'             ╭──────────────────────── locals ─────────────────────────╮                                   │
│   332 │   │   size = f"{pkt.get('packet_size', 0)} B"                                          │    dst_ip = '192.168.1.105'                             │                                   │
│   333 │   │                                                                                    │  dst_port = 35402                                       │                                   │
│ ❱ 334 │   │   table.add_row(pkt_id, timestamp, f"{src_ip}→{dst_ip}", proto, ports, size)       │   filters = {'src_ip': '192.168.1.1'}                   │                                   │
│   335 │                                                                                        │     limit = 10                                          │                                   │
│   336 │   console.print(table)                                                                 │   packets = [                                           │                                   │
│   337                                                                                          │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 34,                           │                                   │
│                                                                                                │             │   │   'timestamp': 1767616240.5170667,    │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.1',            │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'UDP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 53,                     │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   },                                      │                                   │
│                                                                                                │             │   {                                       │                                   │
│                                                                                                │             │   │   'id': 33,                           │                                   │
│                                                                                                │             │   │   'timestamp': 1767616240.517066,     │                                   │
│                                                                                                │             │   │   'src_mac': '30:de:4b:e1:c8:c0',     │                                   │
│                                                                                                │             │   │   'dst_mac': 'e8:fb:1c:d7:ee:c5',     │                                   │
│                                                                                                │             │   │   'ether_type': 'IPv4',               │                                   │
│                                                                                                │             │   │   'src_ip': '192.168.1.1',            │                                   │
│                                                                                                │             │   │   'dst_ip': '192.168.1.105',          │                                   │
│                                                                                                │             │   │   'ip_protocol': 'UDP',               │                                   │
│                                                                                                │             │   │   'ttl': 64,                          │                                   │
│                                                                                                │             │   │   'src_port': 53,                     │                                   │
│                                                                                                │             │   │   ... +5                              │                                   │
│                                                                                                │             │   }                                       │                                   │
│                                                                                                │             ]                                           │                                   │
│                                                                                                │       pkt = {                                           │                                   │
│                                                                                                │             │   'id': 34,                               │                                   │
│                                                                                                │             │   'timestamp': 1767616240.5170667,        │                                   │
│                                                                                                │             │   'src_mac': '30:de:4b:e1:c8:c0',         │                                   │
│                                                                                                │             │   'dst_mac': 'e8:fb:1c:d7:ee:c5',         │                                   │
│                                                                                                │             │   'ether_type': 'IPv4',                   │                                   │
│                                                                                                │             │   'src_ip': '192.168.1.1',                │                                   │
│                                                                                                │             │   'dst_ip': '192.168.1.105',              │                                   │
│                                                                                                │             │   'ip_protocol': 'UDP',                   │                                   │
│                                                                                                │             │   'ttl': 64,                              │                                   │
│                                                                                                │             │   'src_port': 53,                         │                                   │
│                                                                                                │             │   ... +5                                  │                                   │
│                                                                                                │             }                                           │                                   │
│                                                                                                │    pkt_id = ('34',)                                     │                                   │
│                                                                                                │     ports = '53→35402'                                  │                                   │
│                                                                                                │     proto = 'UDP'                                       │                                   │
│                                                                                                │  protocol = None                                        │                                   │
│                                                                                                │      size = '261 B'                                     │                                   │
│                                                                                                │    src_ip = '192.168.1.1'                               │                                   │
│                                                                                                │  src_port = 53                                          │                                   │
│                                                                                                │     table = <rich.table.Table object at 0x7f14d4bb3770> │                                   │
│                                                                                                │ timestamp = '2026-01-05 18:00:40'                       │                                   │
│                                                                                                ╰─────────────────────────────────────────────────────────╯                                   │
│                                                                                                                                                                                              │
│ /home/kartik/Documents/project/netsense/myenv/lib/python3.13/site-packages/rich/table.py:465 in add_row                                                                                      │
│                                                                                                                                                                                              │
│    462 │   │   │   elif is_renderable(renderable):                                                                                                                                           │
│    463 │   │   │   │   add_cell(column, renderable)                                                                                                                                          │
│    464 │   │   │   else:                                                                                                                                                                     │
│ ❱  465 │   │   │   │   raise errors.NotRenderableError(                                                                                                                                      │
│    466 │   │   │   │   │   f"unable to render {type(renderable).__name__}; a string or other re                                                                                              │
│    467 │   │   │   │   )                                                                                                                                                                     │
│    468 │   │   self.rows.append(Row(style=style, end_section=end_section))                                                                                                                   │
│                                                                                                                                                                                              │
│ ╭─────────────────────────────────────────────────── locals ───────────────────────────────────────────────────╮                                                                             │
│ │ cell_renderables = [('34',), '2026-01-05 18:00:40', '192.168.1.1→192.168.1.105', 'UDP', '53→35402', '261 B'] │                                                                             │
│ │           column = Column(                                                                                   │                                                                             │
│ │                    │   header='ID',                                                                          │                                                                             │
│ │                    │   footer='',                                                                            │                                                                             │
│ │                    │   header_style='',                                                                      │                                                                             │
│ │                    │   footer_style='',                                                                      │                                                                             │
│ │                    │   style='dim',                                                                          │                                                                             │
│ │                    │   justify='left',                                                                       │                                                                             │
│ │                    │   vertical='top',                                                                       │                                                                             │
│ │                    │   overflow='ellipsis',                                                                  │                                                                             │
│ │                    │   width=None,                                                                           │                                                                             │
│ │                    │   min_width=None,                                                                       │                                                                             │
│ │                    │   max_width=None,                                                                       │                                                                             │
│ │                    │   ratio=None,                                                                           │                                                                             │
│ │                    │   no_wrap=False,                                                                        │                                                                             │
│ │                    │   highlight=False,                                                                      │                                                                             │
│ │                    │   _index=0,                                                                             │                                                                             │
│ │                    │   _cells=[]                                                                             │                                                                             │
│ │                    )                                                                                         │                                                                             │
│ │          columns = [                                                                                         │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='ID',                                                                      │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='dim',                                                                      │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=0,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   ),                                                                                    │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='Timestamp',                                                               │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='cyan',                                                                     │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=1,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   ),                                                                                    │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='Src → Dst',                                                               │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='yellow',                                                                   │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=2,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   ),                                                                                    │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='Protocol',                                                                │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='green',                                                                    │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=3,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   ),                                                                                    │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='Ports',                                                                   │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='magenta',                                                                  │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=4,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   ),                                                                                    │                                                                             │
│ │                    │   Column(                                                                               │                                                                             │
│ │                    │   │   header='Size',                                                                    │                                                                             │
│ │                    │   │   footer='',                                                                        │                                                                             │
│ │                    │   │   header_style='',                                                                  │                                                                             │
│ │                    │   │   footer_style='',                                                                  │                                                                             │
│ │                    │   │   style='blue',                                                                     │                                                                             │
│ │                    │   │   justify='left',                                                                   │                                                                             │
│ │                    │   │   vertical='top',                                                                   │                                                                             │
│ │                    │   │   overflow='ellipsis',                                                              │                                                                             │
│ │                    │   │   width=None,                                                                       │                                                                             │
│ │                    │   │   min_width=None,                                                                   │                                                                             │
│ │                    │   │   max_width=None,                                                                   │                                                                             │
│ │                    │   │   ratio=None,                                                                       │                                                                             │
│ │                    │   │   no_wrap=False,                                                                    │                                                                             │
│ │                    │   │   highlight=False,                                                                  │                                                                             │
│ │                    │   │   _index=5,                                                                         │                                                                             │
│ │                    │   │   _cells=[]                                                                         │                                                                             │
│ │                    │   )                                                                                     │                                                                             │
│ │                    ]                                                                                         │                                                                             │
│ │      end_section = False                                                                                     │                                                                             │
│ │            index = 0                                                                                         │                                                                             │
│ │       renderable = ('34',)                                                                                   │                                                                             │
│ │      renderables = (('34',), '2026-01-05 18:00:40', '192.168.1.1→192.168.1.105', 'UDP', '53→35402', '261 B') │                                                                             │
│ │             self = <rich.table.Table object at 0x7f14d4bb3770>                                               │                                                                             │
│ │            style = None                                                                                      │                                                                             │
│ ╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────╯                                                                             │
╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
NotRenderableError: unable to render tuple; a string or other renderable object is required
                                                                                             